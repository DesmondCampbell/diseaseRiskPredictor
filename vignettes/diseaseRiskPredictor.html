<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Desmond Campbell" />

<meta name="date" content="2017-10-10" />

<title>Disease Risk Predictor</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Disease Risk Predictor</h1>
<h4 class="author"><em>Desmond Campbell</em></h4>
<h4 class="date"><em>2017-10-10</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#example">Example</a><ul>
<li><a href="#creating-a-disease-model">Creating a Disease model</a><ul>
<li><a href="#epidemiology">Epidemiology</a></li>
<li><a href="#building-a-model">Building a model</a></li>
</ul></li>
<li><a href="#disease-pedigree">Disease Pedigree</a></li>
<li><a href="#calculating-the-pedigree-members-risks">Calculating the Pedigree Members’ Risks</a><ul>
<li><a href="#risk">Risk</a></li>
<li><a href="#n-year-risk">N Year Risk</a></li>
</ul></li>
</ul></li>
<li><a href="#see-also">See Also</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#methodology">Methodology</a></li>
<li><a href="#contacts">Contacts</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This package facilitates</p>
<ul>
<li>developing disease models from epidemiolgical findings</li>
<li>predicting disease risk for the individuals of a family (pedigree), based on these disease models.</li>
</ul>
<p>Multifactorial dichotomous disorders, i.e. disorders characterised by two states - affected v unaffected, are modelled using the liability threshold model. All the following features can be incorporated in combination:</p>
<ul>
<li>partitioning of population liability variance into genetic, shared environment and unique environment effects.</li>
<li>categorical risk factors (e.g. sex, smoker, major genetic risk loci),</li>
<li>quantitative risk factors (e.g. BMI, polygenic score),</li>
<li>age of onset curves</li>
</ul>
<p>The package allows application of such models to disease pedigrees. Pedigree related outputs are</p>
<ul>
<li>individual disease risk for pedigree members</li>
<li>n year disease risk for pedigree members</li>
<li>the disease pedigree liability distribution.</li>
</ul>
<p>The disease model allows evidence available from personal attributes and family history to be appropriately weighed in construction of the disease pedigree’s liability distribution. Predictions of lifetime and n year risk are calculated, per pedigree member, from this distribution.</p>
<p>The package is the engine behind a website</p>
<ul>
<li><a href="http://grass.cgs.hku.hk:3838/mdrc/current" class="uri">http://grass.cgs.hku.hk:3838/mdrc/current</a></li>
</ul>
<p>The website allows</p>
<ul>
<li>disease model construction</li>
<li>disease pedigree construction</li>
<li>disease risk prediction for pedigree members</li>
</ul>
<p>Example disease models and pedigrees are provided at the website and are used in accompanying tutorials to illustrate the features available.</p>
<p>We focus on dichotomous multifactorial disease. Models for single-gene (Mendelian) diseases can be constructed (using major genetic risk locii as categorical risk factors). We cannot vouch for the appropriateness of such models as our expertise is in multifactorial disease. Disorders/traits of a continuous nature (e.g. blood pressure) are not handled.</p>
</div>
<div id="example" class="section level1">
<h1>Example</h1>
<p>The package allows the prediction of disease risk for the individuals of a family (pedigree), based on a disease model. This example demonstrates the typically use of the package. We will</p>
<ol style="list-style-type: decimal">
<li>create a disease model</li>
<li>look at a disease pedigree</li>
<li>predict disease risk for the pedigree members based on the disease model</li>
</ol>
<div id="creating-a-disease-model" class="section level2">
<h2>Creating a Disease model</h2>
<div id="epidemiology" class="section level3">
<h3>Epidemiology</h3>
<p>We consider a model for Major Depression, which illustrates many of the features available. Disease lifetime risk is 15%, liability follows an AE model with heritability of 66%. The disease risk for females is twice that of males. Of the 15% destined to suffer the disease, 80% will have done so by the age of 44. Hopefully, how these features are represented in the disease model object shown below is obvious.</p>
<p>Somewhat counter-intuitively, gender is a component of non-shared environmental effect. This is correct; my sex does not predict that of my sibling. Sex is genetically determined, but whether we inherit an X or Y paternal chromosome, is a random event. This is represented in the covMatrixAsq, covMatrixCsq and covMatrixEsq elements of the disease model object.</p>
<p>The following code reports the baseline disease model object we will use.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(diseaseRiskPredictor))

<span class="co"># copy depression disease model into current environment</span>
lDis &lt;-<span class="st"> </span>diseaseRiskPredictor::lDisDepression

<span class="co"># report the depression disease model</span>
lDis</code></pre></div>
<pre><code>## $title
## [1] &quot;Depression Disease Model&quot;
## 
## $description
## [1] &quot;This is a disease model for depression.&quot;                                               
## [2] &quot;Lifetime risk depends on sex, being twice as high in females as males.&quot;                
## [3] &quot;The age of onset curve doesn't differ between the sexes.&quot;                              
## [4] &quot;This model is based on a model for Major Depression justified in Campbell et al. 2010.&quot;
## [5] &quot;The Campbell et al. model had sex specific age of onset curves.&quot;                       
## [6] &quot;However male and female age of onset curves are similar and have been merged here.&quot;    
## 
## $lifetimeRisk
## [1] 0.15
## 
## $heritability
## [1] 0.66
## 
## $ageOfOnset
##   age expressedProportionOfLifetimeRisk
## 1   0                             0.000
## 2  14                             0.025
## 3  24                             0.235
## 4  34                             0.560
## 5  44                             0.800
## 6  54                             0.945
## 7  55                             1.000
## 
## $categoricalRiskFactors
##   riskFactor value freq relRisk
## 1        sex     1  0.5       1
## 2        sex     2  0.5       2
## 
## $covMatrixAsq
##    id sex
## 1 sex   0
## 
## $covMatrixCsq
##    id sex
## 1 sex   0
## 
## $covMatrixEsq
##    id sex
## 1 sex   1</code></pre>
</div>
<div id="building-a-model" class="section level3">
<h3>Building a model</h3>
<p>So far the disease model object just contains epidemiological data. In the next bit of code that epidemiological data is used to build a liability threshold disease model. Several items get added to the disease model object and the categoricalRiskFactors table is extended.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># calculate disease model</span>
lDis &lt;-<span class="st"> </span><span class="kw">fnCalcDiseaseModel</span>( lDis )
<span class="kw">names</span>(lDis)</code></pre></div>
<pre><code>##  [1] &quot;title&quot;                  &quot;description&quot;           
##  [3] &quot;lifetimeRisk&quot;           &quot;heritability&quot;          
##  [5] &quot;ageOfOnset&quot;             &quot;categoricalRiskFactors&quot;
##  [7] &quot;liaThr&quot;                 &quot;vsuAllRF&quot;              
##  [9] &quot;vsuCatRF&quot;               &quot;vsuQuaRF&quot;              
## [11] &quot;aCov&quot;</code></pre>
</div>
</div>
<div id="disease-pedigree" class="section level2">
<h2>Disease Pedigree</h2>
<p>The linkage/ped file format is a well known format for specifying family trees. Each row pertains to one pedigree member. We represent disease pedigrees in a data.frame with a similar structure. The following code reports a three generation pedigree with one affected member.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># copy 3 generation pedigree into current environment</span>
dfPed &lt;-<span class="st"> </span>diseaseRiskPredictor::dfPed3Gen1Aff
dfPed</code></pre></div>
<pre><code>##   famid id fatherid motherid sex affected age deceased
## 1     1 11        0        0   1        0  69        1
## 2     1 12        0        0   2        0  69        0
## 3     1 21       11       12   1        0  34        0
## 4     1 22       11       12   2        0  34        0
## 5     1 23       11       12   1        1  36        0
## 6     1 24        0        0   2       NA  34        0
## 7     1 31       23       24   1        0   7        0
## 8     1 32       23       24   2        0   8        0</code></pre>
<p>The ped file format is hard to read, this makes pedigree mis-specification hard to detect. To help guard against that, we provide functionality allowing</p>
<ul>
<li>the validity of the pedigree to be checked</li>
<li>the pedigree to be plotted</li>
</ul>
<p>The next bit of code performs various checks on the validity of the pedigree.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># validate pedigree (also performs type conversion on some columns, hence the returned object)</span>
dfPed &lt;-<span class="st"> </span><span class="kw">fnValidatePedigree</span>( dfPed )</code></pre></div>
<p>The next bit of code generates the corresponding pedigree diagram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># construct pedigree object</span>
oPedigree &lt;-<span class="st"> </span><span class="kw">fnConstructPedigree</span>( dfPed )

<span class="co"># plot pedigree diagram</span>
<span class="kw">plot</span>(oPedigree)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="calculating-the-pedigree-members-risks" class="section level2">
<h2>Calculating the Pedigree Members’ Risks</h2>
<p>Now let’s apply the Major Depression disease model to the 3 generation pedigree. The following code does that.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lPedDis &lt;-<span class="st"> </span><span class="kw">fnPrepareForRiskPrediction</span>( dfPed, lDis )

<span class="co"># calculate pedigree members' risks of depression</span>
lRes &lt;-<span class="st"> </span><span class="kw">fnPredictRisk</span>( lPedDis )</code></pre></div>
<pre><code>## INFO: iteration 0 of 30000
## INFO: iteration 1000 of 30000
## INFO: iteration 2000 of 30000
## INFO: iteration 3000 of 30000
## INFO: iteration 4000 of 30000
## INFO: iteration 5000 of 30000
## INFO: iteration 6000 of 30000
## INFO: iteration 7000 of 30000
## INFO: iteration 8000 of 30000
## INFO: iteration 9000 of 30000
## INFO: iteration 10000 of 30000
## INFO: iteration 11000 of 30000
## INFO: iteration 12000 of 30000
## INFO: iteration 13000 of 30000
## INFO: iteration 14000 of 30000
## INFO: iteration 15000 of 30000
## INFO: iteration 16000 of 30000
## INFO: iteration 17000 of 30000
## INFO: iteration 18000 of 30000
## INFO: iteration 19000 of 30000
## INFO: iteration 20000 of 30000
## INFO: iteration 21000 of 30000
## INFO: iteration 22000 of 30000
## INFO: iteration 23000 of 30000
## INFO: iteration 24000 of 30000
## INFO: iteration 25000 of 30000
## INFO: iteration 26000 of 30000
## INFO: iteration 27000 of 30000
## INFO: iteration 28000 of 30000
## INFO: iteration 29000 of 30000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># report contents of the results object</span>
<span class="kw">names</span>(lRes)</code></pre></div>
<pre><code>##  [1] &quot;dfPed&quot;         &quot;lDis&quot;          &quot;mPopCov&quot;       &quot;mPopMean&quot;     
##  [5] &quot;mPriorCov&quot;     &quot;mPriorMean&quot;    &quot;mTotLiaSample&quot; &quot;mPostCov&quot;     
##  [9] &quot;mPostMean&quot;     &quot;mAutoCor&quot;      &quot;dfPedRisk&quot;</code></pre>
<div id="risk" class="section level3">
<h3>Risk</h3>
<p>The results object returned is a named list. One of its elements (dfPedRisk) contains pedigree members’ predicted risk. The following code reports and also plots the pedigree members’ risks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># report pedigree members' risks</span>
lRes$dfPedRisk[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>:<span class="dv">7</span>,<span class="dv">11</span>:<span class="dv">12</span>)]</code></pre></div>
<pre><code>##   id fatherid sex affected age expressedProportionOfLifetimeRisk      risk
## 1 11        0   1        0  69                        1.00000000 0.0000000
## 2 12        0   2        0  69                        1.00000000 0.0000000
## 3 21       11   1        0  34                        0.56000000 0.0622000
## 4 22       11   2        0  34                        0.56000000 0.1423667
## 5 23       11   1        1  36                        0.60800000 1.0000000
## 6 24        0   2       NA  34                        0.56000000 0.1978000
## 7 31       23   1        0   7                        0.01250000 0.2043667
## 8 32       23   2        0   8                        0.01428571 0.3584000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot pedigree members' risks</span>
<span class="kw">fnBarPlotRisk</span>( lRes$dfPedRisk )</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Looking at the above barplot some features are apparent. There is a sex difference in risk, with females more at risk. For instance, siblings 21 and 22 are identical in all relevant variables except for sex. Ditto, siblings 31 and 32.</p>
<p>The effect of age on risk prediction is also apparent. Persons 11, 21 and 31 are all unaffected 1st degree male relatives of the affected person, their only (relevant) difference is in age. This dramatically influenced their disease risk. Ditto, females 12, 22 and 32.</p>
<p>Person 24’s affection status is not known. Her only genetic relations in the pedigree are persons 31 and 32. Both are unaffected, but that status is uninformative due to their age. Consequently there is no pedigree information informing on her risk. Her risk should then be the population lifetime risk for females. That is indeed the case. The following code reports</p>
<ul>
<li><code>risk</code> column - the population lifetime risk for each risk factor category</li>
<li><code>propPopAff</code> column - the contribution of each risk factor stratum to the affected population.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lRes$lDis$categoricalRiskFactors[,<span class="dv">1</span>:<span class="dv">7</span>]</code></pre></div>
<pre><code>##   riskFactor value freq relRisk bRefStratum risk propPopAff
## 1        sex     1  0.5       1        TRUE  0.1       0.05
## 2        sex     2  0.5       2       FALSE  0.2       0.10</code></pre>
</div>
<div id="n-year-risk" class="section level3">
<h3>N Year Risk</h3>
<p>The dfPedRisk object also contains the pedigree members’ 5 year risks, as reported by the following code</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># report pedigree members' risks</span>
lRes$dfPedRisk[,<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>:<span class="dv">7</span>,<span class="dv">13</span>,<span class="dv">18</span>)]</code></pre></div>
<pre><code>##   id fatherid sex affected age nofYears   nYearRisk
## 1 11        0   1        0  69        5         NaN
## 2 12        0   2        0  69        5         NaN
## 3 21       11   1        0  34        5 0.016963636
## 4 22       11   2        0  34        5 0.038827273
## 5 23       11   1        1  36        5 0.000000000
## 6 24        0   2       NA  34        5          NA
## 7 31       23   1        0   7        5 0.001847800
## 8 32       23   2        0   8        5 0.003246377</code></pre>
<p>The <code>nYearRisk</code> column gives risk of developing the condition in the next <em>n</em> years, the <code>nofYears</code> column specifies <em>n</em>. One can see comparing the 2nd and 3rd generations, that the 2nd generation have greater 5 year risk than the 3rd generation (for risks this is reversed). This makes sense given the age of onset curve (in the disease epidemiological findings above).</p>
</div>
</div>
</div>
<div id="see-also" class="section level1">
<h1>See Also</h1>
<p>More complex disease models and pedigrees can be specified. Disease models and pedigrees can be saved/loaded to/from human readable and editable text files. A website built around this package allows interactive</p>
<ul>
<li>disease model construction</li>
<li>disease pedigree construction</li>
<li>disease risk prediction for pedigree members</li>
</ul>
<p>It provides example disease models and pedigrees and tutorials illustrating the features available. It is a lot easier to use than the R command line, so rather than try to explain everything here, I recommend it to interested parties</p>
<ul>
<li><a href="http://grass.cgs.hku.hk:3838/mdrc/current" class="uri">http://grass.cgs.hku.hk:3838/mdrc/current</a></li>
</ul>
</div>
<div id="installation" class="section level1">
<h1>Installation</h1>
<p>If you want to use the R package (as opposed to the website) you will have to install it. You can install from github by entering the folowing at the R prompt</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install it</span>
devtools::<span class="kw">install_github</span>(<span class="st">&quot;DesmondCampbell/diseaseRiskPredictor&quot;</span>)

<span class="co"># attach it</span>
<span class="kw">library</span>(<span class="st">&quot;diseaseRiskPredictor&quot;</span>)</code></pre></div>
<p>For this to work you will have to have already installed the <code>devtools</code> package.</p>
<p>There is currently a bug in the kinship2::plot.pedigree function which prevents it from plotting some valid pedigrees. Run the following command to replace the kinship2 function with a patch function which fixes the bug.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">assignInNamespace</span>( <span class="st">&quot;plot.pedigree&quot;</span>, diseaseRiskPredictor:::plot.pedigree.FIXED, <span class="dt">ns=</span><span class="st">&quot;kinship2&quot;</span>)</code></pre></div>
</div>
<div id="methodology" class="section level1">
<h1>Methodology</h1>
<p>The methodology used in the construction of the disease models is detailed in our paper, Campbell et al. 2017.</p>
<p>Application of the disease model to pedigrees is based on methodology explained in Campbell et al. 2010.</p>
<p>A lot of the pedigree related functionality leans heavily on the R package <code>kinship2</code> (Sinnwell et al. 2014).</p>
</div>
<div id="contacts" class="section level1">
<h1>Contacts</h1>
<p>Feel free to contact us via</p>
<ul>
<li>desmond.campbell @ glasgow.ac.uk</li>
<li>or the contacts listed in Campbell et al. 2017</li>
</ul>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>Campbell et al. 2017. Multifactorial Disease Risk Calculator: Web-based risk prediction for multifactorial disease pedigrees. Genetic Epidemiology.</p>
<p>Campbell DD, Sham PC, Knight J, Wickham H, and Landau S. 2010. Software for Generating Liability Distributions for Pedigrees Conditional on Their Observed Disease States and Covariates. Genetic Epidemiology 34 (2): 159–70. <a href="doi:10.1002/gepi.20446" class="uri">doi:10.1002/gepi.20446</a>.</p>
<p>Sinnwell JP, Therneau TM, and Schaid DJ. 2014. ‘The kinship2 R Package for Pedigree Data’. Human Heredity 78 (2): 91–93. <a href="doi:10.1159/000363105" class="uri">doi:10.1159/000363105</a>.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
